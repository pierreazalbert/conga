var $jscomp={scope:{},executeAsyncGenerator:function(b){function c(a){return b.next(a)}function a(a){return b["throw"](a)}return new Promise(function(d,e){function f(b){b.done?d(b.value):Promise.resolve(b.value).then(c,a).then(f,e)}f(b.next())})}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,a){if(a.get||a.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[c]=a.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var c=0;return $jscomp.iteratorPrototype(function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();var c=b[Symbol.iterator];return c?c.call(b):$jscomp.arrayIterator(b)};
$jscomp.polyfill=function(b,c,a,d){if(c){a=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var e=b[d];e in a||(a[e]={});a=a[e]}b=b[b.length-1];d=a[b];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(a,b,{configurable:!0,writable:!0,value:c})}};$jscomp.EXPOSE_ASYNC_EXECUTOR=!0;$jscomp.FORCE_POLYFILL_PROMISE=!1;var today=moment();
$(document).ready(function(){return $jscomp.executeAsyncGenerator(function(){function b(b,f){for(;;)switch(c){case 0:return e=getParams(window.location.href).key,c=1,{value:getShopData(e),done:!1};case 1:if(void 0===f){c=2;break}c=-1;throw f;case 2:a=d=b,$("#shop-name").text(a.data().name),$("#shop-code").prepend("Shop ID: "+a.data().code[0]+"-"+a.data().code[1]+"-"+a.data().code[2]+"-"+a.data().code[3]),$("#shop-link").prop("href","/book?shop="+a.data().code),$("[name=today]").text(today.format("dddd Do MMMM")),
listenBookings(a),$("#shop-settings > #name").text(a.data().name),$("#shop-settings > #address").text(a.data().address),$.each(a.data().hours,function(a,b){"closed"==b?$("#shop-settings > #hours > > #"+a).text("Closed"):$("#shop-settings > #hours > > #"+a).text(b.open+" to "+b.close)}),$("#shop-settings > #options").text("Accepting "+a.data().bookings.number+" bookings every "+a.data().bookings.rate+" minutes."),c=-1;default:return{value:void 0,done:!0}}}var c=0,a,d,e,f={next:function(a){return b(a,
void 0)},"throw":function(a){return b(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();f[Symbol.iterator]=function(){return this};return f}())});
function renderBookings(b){return $jscomp.executeAsyncGenerator(function(){function c(c,e){for(;;)switch(a){case 0:$("#all-bookings").empty(),d=b.sort(function(a,b){return moment(a.data().time,"HH:mm")-moment(b.data().time,"HH:mm")}),d.forEach(function(a){moment(a.data().time,"HH:mm")<moment()?$("#all-bookings").append('<div class="col-4 col-md-2 p-3 mb-2 d-flex justify-content-center"><label class="w-100 btn btn-outline-secondary nohover btn-lg">#'+a.data().time.replace(":","")+"</label></div>"):
$("#all-bookings").append('<div class="col-4 col-md-2 p-3 mb-2 d-flex justify-content-center"><label class="w-100 font-weight-bold btn btn-outline-dark nohover btn-lg">#'+a.data().time.replace(":","")+"</label></div>")}),a=-1;default:return{value:void 0,done:!0}}}var a=0,d,e={next:function(a){return c(a,void 0)},"throw":function(a){return c(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();e[Symbol.iterator]=function(){return this};return e}())}
function listenBookings(b){return $jscomp.executeAsyncGenerator(function(){function c(c,d){for(;;)switch(a){case 0:return a=1,{value:db.collection("tickets").where("shop","==",b.id).where("date","==",today.format("DD/MM/YYYY")).onSnapshot(function(a){a.empty?(console.log("No bookings found for this shop!"),$("#all-bookings").empty().append('<div class="col-12 mb-2 d-flex justify-content-center"><label class="w-100 btn btn-outline-secondary nohover btn-lg">No bookings found for today</label></div>')):
(console.log("Found following bookings: ",a.docs),renderBookings(a.docs))}),done:!1};case 1:if(void 0===d){a=2;break}a=-1;throw d;case 2:a=-1;default:return{value:void 0,done:!0}}}var a=0,d={next:function(a){return c(a,void 0)},"throw":function(a){return c(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();d[Symbol.iterator]=function(){return this};return d}())}
function getShopData(b){return $jscomp.executeAsyncGenerator(function(){function c(c,k){for(;;)switch(a){case 0:try{return a=3,{value:db.collection("shops").doc(b).get(),done:!1}}catch(g){h=g;a=1;break}case 3:try{if(void 0===k){a=4;break}a=-1;throw k;}catch(g){h=g;a=1;break}case 4:try{e=f=c;if(!e.exists){a=5;break}console.log("Shop data:",e.data());a=-1;return{value:e,done:!0}}catch(g){h=g;a=1;break}case 5:try{console.log("No shop found!"),window.location.href="index.html"}catch(g){h=g;a=1;break}case 6:try{a=
2;break}catch(g){h=g;a=1;break}case 1:d=h,console.log("Error getting shop data:",d),window.location.href="index.html";case 2:a=-1;default:return{value:void 0,done:!0}}}var a=0,d,e,f,h,k={next:function(a){return c(a,void 0)},"throw":function(a){return c(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();k[Symbol.iterator]=function(){return this};return k}())}
var getParams=function(b){var c={},a=document.createElement("a");a.href=b;b=a.search.substring(1).split("&");for(a=0;a<b.length;a++){var d=b[a].split("=");c[d[0]]=decodeURIComponent(d[1])}return c};
